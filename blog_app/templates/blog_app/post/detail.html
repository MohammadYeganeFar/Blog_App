{% extends 'blog_app/base.html' %}

{% block content %}
<h1>{{ post.title }}</h1>
<h4>By {{ post.author.username }}</h4>
<h5>Publisched at: {{ post.created_at}}</h5>
<h2>{{ post.content }}</h2>
<ul>
    <h4>Tags:</h4>
    {% for tag in post.tags.all %}
    <li>{{ tag }}</li>
    {% endfor %}
</ul>
<a href="{% url 'blog_app:add_comment' slug=post.slug %}">Comments</a>
<h5>542 Likes</h5>
<button id=" like-btn" data-slug="{{ post.slug }}">
    👍 <span id="like-count">{{ post.likes.count }}</span>
</button>

<script>
    document.getElementById("like-btn").addEventListener("click", function () {
        const slug = this.getAttribute("data-slug");

        fetch(`like/`, {
            method: "POST",
            headers: {
                "X-CSRFToken": "{{ csrf_token }}",
                "Content-Type": "application/json"
            }
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById("like-count").textContent = data.like_count;
            });
    });
</script>
{% endblock %}